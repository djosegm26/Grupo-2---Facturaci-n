<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">

    <!-- Hoja de estilos general -->
    <link rel="stylesheet" href="/public/css/style.css">

    <!-- T√≠tulo de la p√°gina -->
    <title>Productos</title>
</head>

<body>
    <!-- Encabezado principal -->
    <header>
      <h1>Gesti√≥n de Productos</h1>
    </header>

    <main>

      <!-- ============================================================
          FORMULARIO PARA CREAR UN NUEVO PRODUCTO
          Envia un POST a /productos/nuevo para registrar
      ============================================================ -->
      <form id="productoForm" method="POST" action="/productos/nuevo">
        <input type="text" name="nombre" placeholder="Nombre" required>

        <input type="text" name="descripcion" placeholder="Descripci√≥n">

        <!-- Precio con decimales -->
        <input type="number" step="0.01" name="precio" placeholder="Precio" required>

        <input type="number" name="stock" placeholder="Stock" required>

        <button type="submit">Agregar Producto</button>
      </form>

      <!-- T√≠tulo de la tabla de productos -->
      <h2>Lista de Productos</h2>

      <!-- ============================================================
          TABLA DE PRODUCTOS EXISTENTES
      ============================================================ -->
      <table id="tablaProductos">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Descripci√≥n</th>
            <th>Precio</th>
            <th>Stock</th>

            <!-- Dos columnas combinadas para acciones -->
            <th colspan="2">Acciones</th>
          </tr>
        </thead>

        <tbody>
          <% if (productos && productos.length > 0) { %>

            <!-- Recorre todos los productos -->
            <% productos.forEach((producto) => { %>
              <tr>
                <!-- Muestra los valores del producto -->
                <td><%= producto.nombre %></td>
                <td><%= producto.descripcion %></td>
                <td>$<%= producto.precio %></td>
                <td><%= producto.stock %></td>

                <!-- Acciones: Editar / Eliminar -->
                <td colspan="2" class="text-center">

                  <!-- Bot√≥n de edici√≥n -->
                  <a 
                    href="/productos/editar/<%= producto.id %>" 
                    class="btn btn-warning btn-sm me-2">
                    ‚úèÔ∏è Editar
                  </a>

                  <!-- 
                    Formulario para eliminar producto.
                    Utiliza confirmaci√≥n JS antes de enviar el POST.
                  -->
                  <form 
                    action="/productos/eliminar/<%= producto.id %>" 
                    method="POST" 
                    style="display:inline;"
                    onsubmit="return confirmEliminarProducto(event, '<%= producto.nombre %>');"
                  >
                    <button type="submit" class="btn btn-danger btn-sm">üóëÔ∏è Eliminar</button>
                  </form>

                </td>
              </tr>
            <% }) %>

          <% } else { %>

            <!-- Mostrar si no existen productos -->
            <tr>
              <td colspan="6">No hay productos registrados.</td>
            </tr>

          <% } %>
        </tbody>
      </table>

    </main>

    <!-- ============================================================
        SCRIPT: Confirmaci√≥n antes de eliminar un producto
    ============================================================ -->
    <script>
      function confirmEliminarProducto(event, nombre) {
        return confirm(
          '¬øEst√°s seguro que deseas eliminar el producto "' 
          + nombre + 
          '"? Esta acci√≥n no se puede deshacer.'
        );
      }
    </script>

</body>
</html>




